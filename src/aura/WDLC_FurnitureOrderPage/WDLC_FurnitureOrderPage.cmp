<!--
 - Created by Mateusz Wiorek on 24.03.2020.
 -->

<aura:component description="WDLC_FurnitureOrderPage" controller="WDLC_FurnitureOrderController"
                implements="forceCommunity:availableForAllPageTypes">
    <aura:attribute type="Object[]" name="productsToOrder" access="global"/>
    <aura:attribute type="String" name="totalPrice"/>
    <aura:attribute type="User" name="userInfo" access="global"/>
    <aura:attribute type="String" name="billingStreet"/>
    <aura:attribute type="String" name="billingPostalCode"/>
    <aura:attribute type="String" name="billingState"/>
    <aura:attribute type="String" name="billingCountry"/>
    <aura:attribute type="String" name="billingCity"/>
    <aura:attribute type="Object" name="orderSummary"/>
    <aura:attribute type="Boolean" name="showModal"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>

    <lightning:card>
        <div class="slds-grid">
            <div class="slds-col slds-size--5-of-12">
                <lightning:card>
                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                        <thead>
                        <tr class="slds-line-height_reset">
                            <th class="" scope="col"><strong>
                                <div class="slds-truncate" style="width:70px;"
                                     title="{!$Label.c.WDLC_Product}">{!$Label.c.WDLC_Product}</div>
                            </strong></th>
                            <th class="" scope="col"><strong>
                                <div class="slds-truncate slds-truncate_container_10"
                                     title="{!$Label.c.WDLC_Quantity}">{!$Label.c.WDLC_Quantity}
                                </div>
                            </strong></th>
                            <th class="" scope="col"><strong>
                                <div class="slds-truncate slds-truncate_container_10"
                                     title="{!$Label.c.WDLC_UnitPrice}">{!$Label.c.WDLC_UnitPrice}
                                </div>
                            </strong></th>
                            <th class="" scope="col"><strong>
                                <div class="slds-truncate slds-truncate_container_10"
                                     title="{!$Label.c.WDLC_TotalPrice}">{!$Label.c.WDLC_TotalPrice}
                                </div>
                            </strong></th>
                            <th class="" scope="col"><strong>
                                <div class="slds-truncate slds-truncate_container_10"
                                     title="{!$Label.c.WDLC_TotalPrice}">{!$Label.c.WDLC_Action}
                                </div>
                            </strong></th>
                        </tr>
                        </thead>
                        <tbody>
                        <aura:iteration var="cell2" items="{!v.productsToOrder}" indexVar="index">
                            <c:WDLC_OrderTableRow changeEvent="{!c.refreshTable}" cell="{!cell2}"/>
                        </aura:iteration>

                        </tbody>
                    </table>
                    <div class="summary_boldFont">
                        <h2>{!$Label.c.WDLC_TotalPrice}:
                            <lightning:formattedNumber value="{!v.totalPrice}" style="currency"
                                                       currencyCode="{!$Locale.currencyCode}" currencyDisplayAs="symbol"/>
                        </h2>
                    </div>
                </lightning:card>
            </div>
            <div class="slds-col slds-size-1-of-12"/>
            <aura:if isTrue="{!not(empty(v.billingCountry))}">
                <div class="slds-col slds-size--1-of-2" style="padding-right:10px;">
                    <lightning:input label="{!$Label.c.WDLC_City}" value="{!v.billingCity}"/>
                    <lightning:input label="{!$Label.c.WDLC_Street}" value="{!v.billingStreet}"/>
                    <lightning:input label="{!$Label.c.WDLC_PostalCode}" value="{!v.billingPostalCode}"/>
                    <lightning:input label="{!$Label.c.WDLC_State}" value="{!v.billingState}"/>
                    <lightning:input label="{!$Label.c.WDLC_Country}" value="{!v.billingCountry}"/>
                    <center class="productInfo" style="margin-top: 15px;">
                        <lightning:button class="slds-button slds-button_brand"
                                          onclick="{!c.makeOrderr}">{!$Label.c.WDLC_Order}</lightning:button>
                    </center>
                </div>
            </aura:if>
        </div>
    </lightning:card>
    <c:WDLC_FurnitureModalComponent orderSummary="{!v.orderSummary}" typeOfModal="orderSummary"
                                    showModal="{!v.showModal}"/>
    <c:WDL_ShowErrorComponent aura:id="toastComponent"/>
</aura:component>