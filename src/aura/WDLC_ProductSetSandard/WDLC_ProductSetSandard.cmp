<!--
 - Created by Mateusz Wiorek on 09.04.2020.
 -->

<aura:component description="WDLC_ProductSetSandard"
                controller="WDLC_DiscountManagerController" implements="flexiPage:availableForAllPageTypes">
    <aura:attribute name="columns" type="String[]" access="global"/>
    <aura:attribute name="results" type="Object[]" access="global"/>
    <aura:attribute name="hiddenResults" type="Object[]" access="global"/>
    <aura:attribute name="query" type="String" access="global"/>
    <aura:attribute name="pricesToSet" type="Map" access="global" default="{}"/>
    <aura:attribute name="showModal" type="Boolean" access="global" default="false"/>

    <aura:registerEvent name="WDLC_ProgressIndicatorSet" type="c:WDLC_ProgressIndicatorSet"/>

    <aura:handler name="init" value="{!this}" action="{!c.onInit}"/>


    <aura:if isTrue="{!not(empty(v.hiddenResults))}">
        <lightning:card title="{!$Label.c.WDLC_StepStandardPrices}" iconName="standard:product_item"
                        class="slds-p-around_medium cardHeight">
            <aura:set attribute="actions">
                <div style="display: flex; justify-content : space-evenly;  align-items: flex-end">
                    <lightning:input type="text" placeholder="{!$Label.c.WDLC_SearchList}" label=""
                                     value="{!v.query}" onchange="{!c.searchProducts}" class="sldsInput"/>
                </div>
            </aura:set>
            <aura:if isTrue="{!not(empty(v.results))}">
                <div class="slds-scrollable_y" style="max-height:450px;">
                    <lightning:datatable
                            columns="{! v.columns }"
                            data="{! v.results }"
                            keyField="productId"
                            hideCheckboxColumn="true"
                            oncellchange="{!c.handleSettingStandardPrices}"
                    />
                </div>
            </aura:if>
            <aura:set attribute="footer">
                <lightning:button variant="brand" label="{!$Label.c.WDLC_SetNewPrices}" onclick="{!c.handleSubmit}" class="sldsButton"/>
            </aura:set>
        </lightning:card>
    </aura:if>
    <c:WDL_ShowErrorComponent aura:id="informationToast"/>
    <c:WDLC_ErrorToast aura:id="toast"/>
</aura:component>